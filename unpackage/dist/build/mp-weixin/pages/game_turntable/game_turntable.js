(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/game_turntable/game_turntable"],{"0012":function(a,t,e){"use strict";e.r(t);var n=e("1159"),o=e.n(n);for(var i in n)"default"!==i&&function(a){e.d(t,a,function(){return n[a]})}(i);t["default"]=o.a},"085b":function(a,t,e){"use strict";var n=e("c6a4"),o=e.n(n);o.a},1159:function(a,t,e){"use strict";(function(a){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var e={data:function(){return{Utils:this.$Utils,Router:this.$Router,showView:!1,awardsConfig:{chance:!0,awards:[{index:0,name:"谢谢参与",type:1}]},awardsList:{},animationData:{},btnDisabled:"",chishu:2,mainData:[],imgUrl:"",userInfoData:{},awardIndex:""}},onLoad:function(){var a=this;a.paginate=a.$Utils.cloneForm(a.$AssetsConfig.paginate),a.$Utils.loadAll(["getMainData","getUserInfoData"],a)},onReady:function(t){a.showShareMenu({withShareTicket:!0})},methods:{getUserInfoData:function(){var t=this,e=new Date((new Date).setHours(0,0,0,0)).getTime()/1e3,n=Date.parse(new Date)/1e3,o={tokenFuncName:"getProjectToken"};o.searchItem={user_no:a.getStorageSync("user_info").user_no},o.getAfter={todayScore:{tableName:"Log",searchItem:{create_time:["between",[e,n]],status:1,type:4,user_no:wx.getStorageSync("user_info").user_no,relation_table:"product"},middleKey:"user_no",key:"user_no",condition:"in",compute:{count:["count","count",{create_time:["between",[e,n]],status:1,type:4,user_no:wx.getStorageSync("user_info").user_no,relation_table:"product"}]}}};var i=function(a){a.info.data.length>0&&(t.userInfoData=a.info.data[0]),t.$Utils.finishFunc("getUserInfoData")};t.$apis.userInfoGet(o,i)},getMainData:function(){var a=this,t=this,e={searchItem:{thirdapp_id:2,type:4},paginate:{count:0,currentPage:1,is_page:!0,pagesize:10}},n=function(e){if(e.info.data.length>0){t.mainData.push.apply(t.mainData,e.info.data);for(var n=0;n<t.mainData.length;n++)t.awardsConfig.awards.push({index:n+1,name:t.mainData[n].title,type:0,id:t.mainData[n].id,product:t.mainData[n]})}else t.$Utils.showToast("没有更多了","none");t.imgUrl="../../static/images/game-icon-"+t.awardsConfig.awards.length+".png",console.log("self.awardsConfig.awards",t.awardsConfig.awards),a.drawAwardRoundel(),console.log("self.mainData",t.mainData),t.$Utils.finishFunc("getMainData")};t.$apis.productGet(e,n)},logAdd:function(t){var e=this,n=this,o={tokenFuncName:"getProjectToken"};o.data={type:4,relation_table:"product",trade_info:"抽奖记录",user_no:a.getStorageSync("user_info").user_no,thirdapp_id:2};var i=function(o){1e5==o.solely_code?(a.setStorageSync("canClick",!1),0==t?(a.showModal({title:"恭喜",content:"获得"+n.awardsConfig.awards[n.awardIndex].name,showCancel:!1}),e.btnDisabled=""):(a.showModal({title:"很遗憾",content:"没中奖 谢谢参与",showCancel:!1}),e.btnDisabled=""),n.getUserInfoData()):a.setStorageSync("canClick",!1)};n.$apis.logAdd(o,i)},drawAwardRoundel:function(){for(var a=this.awardsConfig.awards,t=[],e=1/a.length*360,n=0;n<a.length;n++)t.push({turn:n*e+"deg",lineTurn:n*e+e/2+"deg",award:a[n].name});this.btnDisabled=this.awardsConfig.chance?"":"disabled",this.awardsList=t},playReward:function(){var t=this;if(a.setStorageSync("canClick",!1),t.userInfoData.todayScore.count>=5)return a.setStorageSync("canClick",!0),void a.showToast({title:"抽奖次数已经用完",icon:"none"});var e=Math.round(10*Math.random());e>6?(console.log("self.awardsConfig.awards.length",t.awardsConfig.awards.length),t.awardIndex=Math.ceil(Math.random()*(t.awardsConfig.awards.length-1))):t.awardIndex=0,console.log("awardTest",e);var n=this.awardsConfig.awards,o=10,i=3e3;this.runDeg=this.runDeg||0,this.runDeg=this.runDeg+(360-this.runDeg%360)+(360*o-t.awardIndex*(360/n.length));var r=a.createAnimation({duration:i,timingFunction:"ease"});r.rotate(this.runDeg).step(),this.animationData=r.export(),this.btnDisabled="disabled";var s=this.awardsConfig,d=s.awards[t.awardIndex].type;this.chishu=this.chishu-1,0==d?setTimeout(function(){var e=this,n={product:[{id:s.awards[t.awardIndex].id,count:1,product:s.awards[t.awardIndex].product}],type:s.awards[t.awardIndex].product.type},o=t.$Utils.cloneForm(n);o.tokenFuncName="getProjectToken",o.data={pay_status:1};var r=function(n){n&&1e5==n.solely_code?setTimeout(function(){t.logAdd("0")}.bind(e),i):(a.setStorageSync("canClick",!0),a.showToast({title:n.msg,duration:2e3}))};t.$apis.addOrder(o,r)}.bind(this),i):setTimeout(function(){t.logAdd("1")}.bind(this),i)}}};t.default=e}).call(this,e("543d")["default"])},"237c":function(a,t,e){"use strict";(function(a){e("10a4"),e("921b");n(e("66fd"));var t=n(e("3d3d"));function n(a){return a&&a.__esModule?a:{default:a}}a(t.default)}).call(this,e("543d")["createPage"])},"3d3d":function(a,t,e){"use strict";e.r(t);var n=e("f30a"),o=e("0012");for(var i in o)"default"!==i&&function(a){e.d(t,a,function(){return o[a]})}(i);e("085b");var r=e("2877"),s=Object(r["a"])(o["default"],n["a"],n["b"],!1,null,null,null);t["default"]=s.exports},c6a4:function(a,t,e){},f30a:function(a,t,e){"use strict";var n=function(){var a=this,t=a.$createElement;a._self._c;a._isMounted||(a.e0=function(t){return a.Router.navigateTo({route:{path:"/pages/game_turntable_rule/game_turntable_rule"}})},a.e1=function(t){return a.Utils.stopMultiClick(a.playReward)},a.e2=function(t){return a.Router.navigateTo({route:{path:"/pages/game_turntable_winRecord/game_turntable_winRecord"}})})},o=[];e.d(t,"a",function(){return n}),e.d(t,"b",function(){return o})}},[["237c","common/runtime","common/vendor"]]]);