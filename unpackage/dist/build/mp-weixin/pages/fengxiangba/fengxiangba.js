(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/fengxiangba/fengxiangba"],{7312:function(a,e,t){"use strict";t.r(e);var n=t("8338"),o=t.n(n);for(var i in n)"default"!==i&&function(a){t.d(e,a,function(){return n[a]})}(i);e["default"]=o.a},8338:function(a,e,t){"use strict";(function(a){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var t={data:function(){return{Router:this.$Router,mainDataTwo:[],num:1,mainData:[],Utils:this.$Utils,canClick:!0,isPre:!1}},onLoad:function(a){var e=this;e.paginate=e.$Utils.cloneForm(e.$AssetsConfig.paginate)},onPullDownRefresh:function(){console.log("refresh");var e=this;1==e.num?e.getMainData(!0):e.getMainDataTwo(!0),setTimeout(function(){a.stopPullDownRefresh()},1e3)},onShow:function(){var e=this;a.getStorageSync("index")&&(console.log(332423),e.num=2,e.mainDataTwo=[],e.paginate={count:0,currentPage:1,is_page:!0,pagesize:5},e.$Utils.loadAll(["getMainDataTwo"],e)),a.removeStorageSync("index"),console.log("self.num",e.num),1!=e.num||e.isPre||(e.mainData=[],e.paginate={count:0,currentPage:1,is_page:!0,pagesize:5},e.$Utils.loadAll(["getMainData"],e),e.isPre=!1)},onReachBottom:function(){console.log("onReachBottom");var e=this;!e.isLoadAll&&a.getStorageSync("loadAllArray")&&(e.paginate.currentPage++,1==e.num?e.getMainData():e.getMainDataTwo())},methods:{previewImage:function(e,t){var n=this;n.isPre=!0,console.log(e),console.log(t),a.previewImage({urls:n.mainData[e].bannerImg,current:t,longPressActions:{itemList:["发送给朋友","保存图片","收藏"],success:function(a){console.log("选中了第"+(a.tapIndex+1)+"个按钮,第"+(a.index+1)+"张图片")},fail:function(a){console.log(a.errMsg)}}})},formIdAdd:function(a){var e=this;e.$apis.WxFormIdAdd(a.detail.formId,Date.parse(new Date)/1e3+604800)},changeone:function(a){var e=this;a!=e.num&&(e.num=a,1==e.num?e.getMainData(!0):e.getMainDataTwo(!0))},clickFollow:function(e){var t=this;if(console.log("self.canClick",t.canClick),0!=t.canClick){if(t.canClick=!1,console.log(e),t.mainData[e].user_no==a.getStorageSync("user_info").user_no)return t.canClick=!0,void t.$Utils.showToast("不能关注自己","none",1e3);0==t.mainData[e].follow.length?t.addFollowLog(e):t.updateFollowLog(e)}else console.log("stop")},addFollowLog:function(e){var t=this,n=Date.parse(new Date);n=t.$Utils.timeto(n,"ymd-hms");var o={};o.data={type:3,title:"关注成功",relation_user:t.mainData[e].user_no,relation_table:"User",user_no:a.getStorageSync("user_info").user_no},o.tokenFuncName="getProjectToken",o.saveFunction=[{FuncName:"wxTemplate",searchItem:{user_no:t.mainData[e].user_no},template:"关注提醒",data_arr:{keyword1:{value:t.mainData[e].description},keyword2:{value:""!=a.getStorageSync("user_info").nickname?a.getStorageSync("user_info").nickname:"用户"+a.getStorageSync("user_info").user_no},keyword3:{value:n},keyword4:{value:"你发布的文章，有用户关注啦!"}},thirdapp_id:2}];var i=function(a){if(1e5==a.solely_code){for(var n=0;n<t.mainData.length;n++)t.mainData[n].user_no==t.mainData[e].user_no&&t.mainData[n].follow.push({status:1,id:a.info.id});t.$Utils.showToast("关注成功","none",1e3)}else t.$Utils.showToast("关注失败","none",1e3);t.canClick=!0};t.$apis.logAdd(o,i)},updateFollowLog:function(e){var t=this,n=Date.parse(new Date);n=t.$Utils.timeto(n,"ymd-hms");var o={searchItem:{id:t.mainData[e].follow[0].id},data:{status:-t.mainData[e].follow[0].status},tokenFuncName:"getProjectToken"};-1==t.mainData[e].follow[0].status&&(o.saveFunction=[{FuncName:"wxTemplate",searchItem:{user_no:t.mainData[e].user_no},template:"关注申请提醒",data_arr:{keyword1:{value:t.mainData[e].description},keyword2:{value:""!=a.getStorageSync("user_info").nickname?a.getStorageSync("user_info").nickname:"用户"+a.getStorageSync("user_info").user_no},keyword3:{value:n},keyword4:{value:"你发布的文章，有用户关注啦!"}},thirdapp_id:2}]);var i=function(a){if(t.canClick=!0,1e5==a.solely_code){for(var n=0;n<t.mainData.length;n++)t.mainData[n].user_no==t.mainData[e].user_no&&(t.mainData[n].follow[0].status=-t.mainData[n].follow[0].status);1==t.mainData[e].follow[0].status?t.$Utils.showToast("关注成功","none",1e3):t.$Utils.showToast("取消成功","none",1e3)}else t.$Utils.showToast(a.msg,"none",1e3)};t.$apis.logUpdate(o,i)},getMainData:function(e){var t=this;e&&(t.mainData=[],t.paginate={count:0,currentPage:1,is_page:!0,pagesize:5});var n={};n.paginate=t.$Utils.cloneForm(t.paginate),n.tokenFuncName="getProjectToken",n.searchItem={thirdapp_id:2,user_type:0,type:1,relation_id:0,behavior:1},n.getAfter={follow:{tableName:"Log",searchItem:{status:["in",[1,-1]],type:3,relation_table:"user",user_no:a.getStorageSync("user_info").user_no},middleKey:"user_no",key:"relation_user",condition:"in"},like:{tableName:"Log",searchItem:{status:1,type:1,relation_table:"message"},middleKey:"id",key:"relation_id",condition:"in",compute:{count:["count","count",{status:1}]}},collect:{tableName:"Log",searchItem:{status:1,type:2,relation_table:"message"},middleKey:"id",key:"relation_id",condition:"in",compute:{count:["count","count",{status:1}]}},reply:{tableName:"Message",searchItem:{status:1,type:2},middleKey:"id",key:"relation_id",condition:"in",compute:{count:["count","count",{status:1}]}}};var o=function(a){a.info.data.length>0?t.mainData.push.apply(t.mainData,a.info.data):t.$Utils.showToast("没有更多了","none"),console.log("self.mainData",t.mainData),t.$Utils.finishFunc("getMainData")};t.$apis.messageGet(n,o)},getMainDataTwo:function(a){var e=this;a&&(e.mainDataTwo=[],e.paginate={count:0,currentPage:1,is_page:!0,pagesize:5});var t={};t.paginate=e.$Utils.cloneForm(e.paginate),t.searchItem={thirdapp_id:2},t.getBefore={caseData:{tableName:"Label",searchItem:{title:["=",["活动"]]},middleKey:"menu_id",key:"id",condition:"in"}};var n=function(a){a.info.data.length>0?e.mainDataTwo.push.apply(e.mainDataTwo,a.info.data):e.$Utils.showToast("没有更多了","none"),console.log("self.mainDataTwo",e.mainDataTwo),e.$Utils.finishFunc("getMainDataTwo")};e.$apis.articleGet(t,n)},onShareAppMessage:function(a){console.log(a);var e=this,t=a.target.dataset.index;if("button"===a.from)return{title:e.mainData[t].title,imageUrl:e.mainData[t].bannerImg[0].url,desc:"小蜂拼拼拼社区团购",path:"/pages/fengxiangba_pl/fengxiangba_pl?id="+e.mainData[t].id,success:function(a){console.log("转发成功:"+JSON.stringify(a))},fail:function(a){console.log("转发失败:"+JSON.stringify(a))}}}}};e.default=t}).call(this,t("543d")["default"])},"965b":function(a,e,t){"use strict";var n=function(){var a=this,e=a.$createElement;a._self._c;a._isMounted||(a.e0=function(e){return a.Router.navigateTo({route:{path:"/pages/fengxiangba_fabu/fengxiangba_fabu"}})},a.e1=function(e){return a.Router.navigateTo({route:{path:"/pages/fengxiangba_pl/fengxiangba_pl?id="+e.currentTarget.dataset.id}})},a.e2=function(e){return a.Router.navigateTo({route:{path:"/pages/fengxiangba_pl/fengxiangba_pl?id="+e.currentTarget.dataset.id}})},a.e3=function(e){return a.Router.navigateTo({route:{path:"/pages/fengxiangba_pl/fengxiangba_pl?id="+e.currentTarget.dataset.id}})},a.e4=function(e){return a.Router.navigateTo({route:{path:"/pages/activityDetail/activityDetail?id="+e.currentTarget.dataset.id}})})},o=[];t.d(e,"a",function(){return n}),t.d(e,"b",function(){return o})},b1b5:function(a,e,t){"use strict";var n=t("c741"),o=t.n(n);o.a},c741:function(a,e,t){},e999:function(a,e,t){"use strict";t.r(e);var n=t("965b"),o=t("7312");for(var i in o)"default"!==i&&function(a){t.d(e,a,function(){return o[a]})}(i);t("b1b5");var s=t("2877"),r=Object(s["a"])(o["default"],n["a"],n["b"],!1,null,null,null);e["default"]=r.exports},fe42:function(a,e,t){"use strict";(function(a){t("10a4"),t("921b");n(t("66fd"));var e=n(t("e999"));function n(a){return a&&a.__esModule?a:{default:a}}a(e.default)}).call(this,t("543d")["createPage"])}},[["fe42","common/runtime","common/vendor"]]]);