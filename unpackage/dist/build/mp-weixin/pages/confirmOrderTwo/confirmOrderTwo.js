(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/confirmOrderTwo/confirmOrderTwo"],{"07ee":function(t,e,a){"use strict";var o=function(){var t=this,e=t.$createElement;t._self._c;t._isMounted||(t.e0=function(e){return t.Router.navigateTo({route:{path:"/pages/myAddress/myAddress"}})},t.e1=function(e){return t.Utils.stopMultiClick(t.submit)})},r=[];a.d(e,"a",function(){return o}),a.d(e,"b",function(){return r})},"3dab":function(t,e,a){"use strict";(function(t){a("10a4"),a("921b");o(a("66fd"));var e=o(a("b01e"));function o(t){return t&&t.__esModule?t:{default:t}}t(e.default)}).call(this,a("543d")["createPage"])},"46da":function(t,e,a){},7997:function(t,e,a){"use strict";var o=a("46da"),r=a.n(o);r.a},"801d":function(t,e,a){"use strict";a.r(e);var o=a("fa2f"),r=a.n(o);for(var n in o)"default"!==n&&function(t){a.d(e,t,function(){return o[t]})}(n);e["default"]=r.a},b01e:function(t,e,a){"use strict";a.r(e);var o=a("07ee"),r=a("801d");for(var n in r)"default"!==n&&function(t){a.d(e,t,function(){return r[t]})}(n);a("7997");var s=a("2877"),i=Object(s["a"])(r["default"],o["a"],o["b"],!1,null,null,null);e["default"]=i.exports},fa2f:function(t,e,a){"use strict";(function(t){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var a={data:function(){return{Router:this.$Router,Utils:this.$Utils,addressData:{},mainData:[],totalPrice:0,userInfoData:{},transportFee:0,specialProvince:[],totalScore:0}},onLoad:function(e){var a=this;t.setStorageSync("canClick",!0),a.mainData=t.getStorageSync("payPro"),console.log("self.data.mainData",a.mainData);var o=function(t){a.$Utils.loadAll(["getUserInfoData"],a)};a.$Token.getProjectToken(o,{refreshToken:!0}),a.countTotalPrice(),a.specialProvince=t.getStorageSync("user_info").thirdApp.codeName.split("-"),console.log("self.specialProvince",a.specialProvince)},onShow:function(){var e=this;t.getStorageSync("choosedAddressData")?(e.addressData=t.getStorageSync("choosedAddressData"),e.specialProvince.indexOf(e.addressData.province)>=0?e.transportFee=t.getStorageSync("user_info").thirdApp.custom_rule.special:e.transportFee=t.getStorageSync("user_info").thirdApp.custom_rule.freight):e.getAddressData()},methods:{formIdAdd:function(t){var e=this;console.log(t),e.$apis.WxFormIdAdd(t.detail.formId,Date.parse(new Date)/1e3+604800)},getUserInfoData:function(){var e=this,a={};a.searchItem={user_no:t.getStorageSync("user_info").user_no},a.tokenFuncName="getProjectToken";var o=function(t){t.info.data.length>0?e.userInfoData=t.info.data[0]:e.$Utils.showToast(t.msg,"none"),e.$Utils.finishFunc("getUserInfoData")};e.$apis.userInfoGet(a,o)},submit:function(){var e=this;if(t.setStorageSync("canClick",!1),"{}"==JSON.stringify(e.addressData))t.setStorageSync("canClick",!0),e.$Utils.showToast("请选择收货地址","none");else{if(parseFloat(e.userInfoData.score)<parseFloat(e.totalScore))return t.setStorageSync("canClick",!0),void e.$Utils.showToast("积分不足","none");e.addOrder()}},addOrder:function(){var e=this,a=e.$Utils.cloneForm(e.mainData);a.tokenFuncName="getProjectToken",a.snap_address=e.addressData,a.data={},a.data.transport_type=1,a.data.transport_fee=e.transportFee,a.snap_address=e.addressData;var o=function(a){a&&1e5==a.solely_code?(e.orderId=a.info.id,e.pay()):(t.setStorageSync("canClick",!0),t.showToast({title:a.msg,duration:2e3}))};e.$apis.addOrder(a,o)},pay:function(e){var a=this,o={};o.wxPay={price:(parseFloat(a.totalPrice)+parseFloat(a.transportFee)-parseFloat(a.totalScore)).toFixed(2)},o.score={price:a.totalScore},o.tokenFuncName="getProjectToken",o.searchItem={id:a.orderId},o.saveFunction=[{FuncName:"wxTemplate",searchItem:{user_no:t.getStorageSync("user_info").user_no},template:"使用积分提醒",data_arr:{keyword1:{value:a.totalScore+"分"},keyword2:{value:(parseFloat(a.userInfoData.score)-parseFloat(a.totalScore)).toFixed(2)+"分"}},thirdapp_id:2}];var r=function(e){if(1e5==e.solely_code)if(t.setStorageSync("canClick",!0),e.info){var o=function(e){console.log("payData",e),1==e?(t.showToast({title:"支付成功",duration:1e3,success:function(){}}),setTimeout(function(){a.$Router.redirectTo({route:{path:"/pages/myOrder/myOrder"}})},1e3)):(t.setStorageSync("canClick",!0),t.showToast({title:"支付失败",duration:2e3}))};a.$Utils.realPay(e.info,o)}else t.showToast({title:"支付成功",duration:1e3,success:function(){}}),setTimeout(function(){a.$Router.redirectTo({route:{path:"/pages/myOrder/myOrder"}})},1e3);else t.setStorageSync("canClick",!0),t.showToast({title:e.msg,duration:2e3})};a.$apis.pay(o,r)},getAddressData:function(){var e=this,a={tokenFuncName:"getProjectToken",searchItem:{isdefault:1}},o=function(a){a.info.data.length>0&&(e.addressData=a.info.data[0],e.specialProvince.indexOf(e.addressData.province)>=0?(console.log(21321),e.transportFee=t.getStorageSync("user_info").thirdApp.custom_rule.special):e.transportFee=t.getStorageSync("user_info").thirdApp.custom_rule.freight)};e.$apis.addressGet(a,o)},counter:function(t,e){var a=this;"+"==e?a.mainData.product[t].count++:a.mainData.product[t].count>1&&a.mainData.product[t].count--,a.countTotalPrice()},countTotalPrice:function(){var t=this;t.totalPrice=0,t.totalScore=0;for(var e=0;e<t.mainData.product.length;e++)t.totalPrice+=t.mainData.product[e].product.price*t.mainData.product[e].count,t.totalScore+=t.mainData.product[e].product.score*t.mainData.product[e].count}}};e.default=a}).call(this,a("543d")["default"])}},[["3dab","common/runtime","common/vendor"]]]);