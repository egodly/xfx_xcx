(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/goodsJoinDetail/goodsJoinDetail"],{"0a29":function(e,t,o){"use strict";o.r(t);var a=o("7a37"),n=o("15d2");for(var i in n)"default"!==i&&function(e){o.d(t,e,function(){return n[e]})}(i);o("a341");var s=o("2877"),r=Object(s["a"])(n["default"],a["a"],a["b"],!1,null,null,null);t["default"]=r.exports},"15d2":function(e,t,o){"use strict";o.r(t);var a=o("ec7d"),n=o.n(a);for(var i in a)"default"!==i&&function(e){o.d(t,e,function(){return a[e]})}(i);t["default"]=n.a},"7a37":function(e,t,o){"use strict";var a=function(){var e=this,t=e.$createElement;e._self._c},n=[];o.d(t,"a",function(){return a}),o.d(t,"b",function(){return n})},"7a91":function(e,t,o){"use strict";(function(e){o("10a4"),o("921b");a(o("66fd"));var t=a(o("0a29"));function a(e){return e&&e.__esModule?e:{default:e}}e(t.default)}).call(this,o("543d")["createPage"])},"883a":function(e,t,o){},a341:function(e,t,o){"use strict";var a=o("883a"),n=o.n(a);n.a},ec7d:function(e,t,o){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o={data:function(){return{Router:this.$Router,showView:!1,is_show:!1,show_addok:!1,is_show1:!1,mainData:{},chooseSku:{},noSelectSku:!0,count:1,price:"",groupPrice:"",hasAdd:!1,isVip:!1,groupData:[],countDownList:[],endTimeList:[],chooseGroupData:{},chooseGroupIndex:-1,total:0,hasOrder:!1}},onLoad:function(e){var t=this;t.id=e.id,e.user_no&&(t.user_no=e.user_no,t.isVip=!0),e.leader_no&&(t.leader_no=e.leader_no),e.order_id&&(t.order_id=e.order_id,t.hasOrder=!0),t.paginate=t.$Utils.cloneForm(t.$AssetsConfig.paginate),t.$Utils.loadAll(["getMainData","getUserInfoData"],t)},onUnload:function(){var e=this;clearTimeout(e.countDown())},methods:{getUserInfoData:function(){var t=this;console.log("852369");var o={tokenFuncName:"getProjectToken"};o.searchItem={user_no:e.getStorageSync("user_info").user_no};var a=function(e){1e5==e.solely_code&&e.info.data[0]?t.userInfoData=e.info.data[0]:t.$Utils.showToast(e.msg,"none"),t.$Utils.finishFunc("getUserInfoData")};t.$apis.userInfoGet(o,a)},addToShop:function(){var t=this;if(t.hasAdd)t.$Utils.showToast("商品已在店铺","none");else if(t.userInfoData.level>=3&&2==t.userInfoData.check_status){var o={};o.data={thirdapp_id:2,type:6,relation_table:"product",relation_id:t.id,user_no:e.getStorageSync("user_info").user_no},o.tokenFuncName="getProjectToken";var a=function(e){1e5==e.solely_code?(t.show_addok=!0,t.getMainData()):t.$Utils.showToast(e.msg,"none")};t.$apis.logAdd(o,a)}else t.$Utils.showToast("您暂未拥有店铺","none")},counter:function(e){var t=this;"+"==e?t.count++:"-"==e&&t.count>1&&t.count--,t.countTotalPrice()},countTotalPrice:function(){var e=this;e.price=e.chooseSku.price*e.count.toFixed(2),e.groupPrice=e.chooseSku.group_price*e.count.toFixed(2)},viewMoreGroup:function(){var t=this,o={sku:[{id:t.chooseSku.id,count:t.count,sku:t.chooseSku}],type:t.mainData.type};e.setStorageSync("payPro",o),t.leader_no?t.$Router.navigateTo({route:{path:"/pages/goodsDetail_pintuan/goodsDetail_pintuan?product_no="+t.mainData.product_no+"&leader_no="+t.leader_no}}):t.$Router.navigateTo({route:{path:"/pages/goodsDetail_pintuan/goodsDetail_pintuan?product_no="+t.mainData.product_no}})},goBuy:function(t){var o=this;if("{}"!=JSON.stringify(o.chooseSku)){var a={sku:[{id:o.chooseSku.id,count:o.count,sku:o.chooseSku}],type:o.mainData.type};e.setStorageSync("payPro",a),"{}"!=JSON.stringify(o.chooseGroupData)&&e.setStorageSync("group_no",o.chooseGroupData.group_no),o.leader_no?o.$Router.navigateTo({route:{path:"/pages/confirmOrder/confirmOrder?type="+t+"&leader_no="+o.leader_no}}):o.$Router.navigateTo({route:{path:"/pages/confirmOrder/confirmOrder?type="+t}})}else o.$Utils.showToast("商品错误","none",1e3)},seltSpecs:function(e){var t=this;t.mainData.sku[e].id!=t.chooseSku.id&&(t.chooseSku=t.mainData.sku[e],t.count=1,t.countTotalPrice())},goPinDan:function(){var e=this;e.is_show=!e.is_show},chooseGroup:function(e){var t=this;t.is_show=!0,t.chooseGroupIndex=e,t.chooseGroupData=t.groupData[e],console.log("self.countDownList",t.chooseGroupIndex),console.log("self.countDownList",t.countDownList)},showSel:function(){var e=this;e.is_show1=!e.is_show1},showAddok:function(){var e=this;e.show_addok=!e.show_addok},prev:function(){var e=this;e.$Router.switchTab({route:{path:"/pages/index/index"}})},onShareAppMessage:function(e){console.log(e);var t=this;return"button"!==e.from?{title:t.mainData.title,imageUrl:t.mainData.mainImg[0]&&t.mainData.mainImg[0].url?t.mainData.mainImg[0].url:"",desc:"小蜂拼拼社区团购",path:"/pages/goodsJoinDetail/goodsJoinDetail?id="+t.mainData.id,success:function(e){console.log("转发成功:"+JSON.stringify(e))},fail:function(e){console.log("转发失败:"+JSON.stringify(e))}}:1==e.target.id?0==t.groupData.length?{title:t.mainData.title,imageUrl:t.mainData.mainImg[0]&&t.mainData.mainImg[0].url?t.mainData.mainImg[0].url:"",desc:"小蜂拼拼社区团购",path:"/pages/goodsJoinDetail/goodsJoinDetail?id="+t.mainData.id+"&leader_no="+t.user_no,success:function(e){console.log("转发成功:"+JSON.stringify(e))},fail:function(e){console.log("转发失败:"+JSON.stringify(e))}}:{title:t.mainData.title,imageUrl:t.mainData.mainImg[0]&&t.mainData.mainImg[0].url?t.mainData.mainImg[0].url:"",desc:"小蜂拼拼社区团购",path:"/pages/goodsJoinDetail/goodsJoinDetail?id="+t.mainData.id+"&order_id="+t.groupData[0].id,success:function(e){console.log("转发成功:"+JSON.stringify(e))},fail:function(e){console.log("转发失败:"+JSON.stringify(e))}}:2==e.target.id?{title:t.mainData.title,imageUrl:t.mainData.mainImg[0]&&t.mainData.mainImg[0].url?t.mainData.mainImg[0].url:"",desc:"小蜂拼拼社区团购",path:"/pages/goodsJoinDetail/goodsJoinDetail?id="+t.mainData.id,success:function(e){console.log("转发成功:"+JSON.stringify(e))},fail:function(e){console.log("转发失败:"+JSON.stringify(e))}}:void console.log(e.target)},getMainData:function(){var t=this,o={};o.searchItem={thirdapp_id:2,type:1,id:t.id},o.getAfter={sku:{tableName:"Sku",middleKey:"product_no",key:"product_no",searchItem:{status:1},condition:"="},log:{tableName:"Log",middleKey:"id",key:"relation_id",searchItem:{status:1,type:6,user_no:["in",e.getStorageSync("user_info").user_no]},condition:"="}},o.saveFunction=[{FuncName:"viewProduct",searchItem:{id:t.id}}];var a=function(o){if(o.info.data.length>0){t.mainData=o.info.data[0],t.mainData.sku[0]?(t.chooseSku=t.mainData.sku[0],t.countTotalPrice(),t.getGroupData()):(t.$Utils.showToast("商品信息错误","none"),setTimeout(function(){e.navigateBack({delta:1})},1500)),t.mainData.log.length>0&&(t.hasAdd=!0);var a=new RegExp("<img","gi");t.mainData.content=t.mainData.content.replace(a,'<img style="max-width: 100%;"')}else t.$Utils.showToast("没有更多了","none");console.log("self.mainData",t.mainData),t.$Utils.finishFunc("getMainData")};t.$apis.productGet(o,a)},getGroupData:function(){var e=this;console.log("852369");var t=Date.parse(new Date),o={tokenFuncName:"getProjectToken",paginate:{count:0,currentPage:1,is_page:!0,pagesize:5}};o.searchItem={user_type:0,order_step:4,pay_status:1,product_no:e.mainData.product_no,group_leader:"true",invalid_time:[">",t]},e.leader_no&&(o.searchItem.leader_no=e.leader_no,delete o.searchItem.order_step),e.user_no&&(o.searchItem.leader_no=e.user_no,delete o.searchItem.order_step),o.getAfter={groupMember:{tableName:"Order",middleKey:"group_no",key:"group_no",searchItem:{status:1,pay_status:1},condition:"="},user:{tableName:"User",middleKey:"user_no",key:"user_no",searchItem:{status:1},condition:"="}};var a=function(t){if(1e5==t.solely_code&&t.info.data[0]){e.groupData.push.apply(e.groupData,t.info.data);for(var o=0;o<e.groupData.length;o++)e.endTimeList.push({actEndTime:e.groupData[o].invalid_time}),e.groupData[o].lessNum=parseInt(e.groupData[o].standard)-parseInt(e.groupData[o].groupMember.length);e.leader_no&&(e.is_show=!0,e.chooseGroupIndex=e.groupData.length-1,e.chooseGroupData=e.groupData[e.groupData.length-1])}e.countDown(),e.order_id&&e.getShareOrder(),e.total=t.info.total,e.$Utils.finishFunc("getUserInfoData")};e.$apis.orderGet(o,a)},getShareOrder:function(){var e=this;console.log("852369");var t=Date.parse(new Date),o={tokenFuncName:"getProjectToken",paginate:{count:0,currentPage:1,is_page:!0,pagesize:5}};o.searchItem={user_type:0,pay_status:1,group_leader:"true",invalid_time:[">",t],id:e.order_id},o.getAfter={groupMember:{tableName:"Order",middleKey:"group_no",key:"group_no",searchItem:{status:1,pay_status:1},condition:"="},user:{tableName:"User",middleKey:"user_no",key:"user_no",searchItem:{status:1},condition:"="}};var a=function(t){if(1e5==t.solely_code&&t.info.data[0]){e.groupData.push.apply(e.groupData,t.info.data);for(var o=0;o<e.groupData.length;o++)e.endTimeList.push({actEndTime:e.groupData[o].invalid_time}),e.groupData[o].lessNum=parseInt(e.groupData[o].standard)-parseInt(e.groupData[o].groupMember.length);e.is_show=!0,e.chooseGroupIndex=e.groupData.length-1,e.chooseGroupData=e.groupData[e.groupData.length-1],console.log("self.countDownList",e.chooseGroupIndex),console.log("self.countDownList",e.countDownList)}else e.$Utils.showToast("团数据异常","none");e.countDown(),e.$Utils.finishFunc("getUserInfoData")};e.$apis.orderGet(o,a)},timeFormat:function(e){return e<10?"0"+e:e},countDown:function(){for(var e=this,t=(new Date).getTime(),o=(e.endTimeList,[]),a=0;a<e.endTimeList.length;a++){var n=e.endTimeList[a].actEndTime,i=null;if(n-t>0){var s=(n-t)/1e3,r=parseInt(s/86400),u=parseInt(s%86400/3600),c=parseInt(s%86400%3600/60),d=parseInt(s%86400%3600%60);r>0&&(u+=24*r),i={hou:e.timeFormat(u),min:e.timeFormat(c),sec:e.timeFormat(d)}}else i={hou:"00",min:"00",sec:"00"};o.push(i)}e.countDownList=o,setTimeout(this.countDown,1e3)}}};t.default=o}).call(this,o("543d")["default"])}},[["7a91","common/runtime","common/vendor"]]]);