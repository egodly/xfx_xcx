(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/fengxiangba_fabu/fengxiangba_fabu"],{"4cf2":function(e,t,n){"use strict";n.r(t);var o=n("5cf3"),a=n.n(o);for(var s in o)"default"!==s&&function(e){n.d(t,e,function(){return o[e]})}(s);t["default"]=a.a},"549d":function(e,t,n){"use strict";var o=function(){var e=this,t=e.$createElement;e._self._c;e._isMounted||(e.e0=function(t){return e.Utils.stopMultiClick(e.submit)})},a=[];n.d(t,"a",function(){return o}),n.d(t,"b",function(){return a})},"5c0d":function(e,t,n){"use strict";(function(e){n("10a4"),n("921b");o(n("66fd"));var t=o(n("775b"));function o(e){return e&&e.__esModule?e:{default:e}}e(t.default)}).call(this,n("543d")["createPage"])},"5cf3":function(e,t,n){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n={data:function(){return{Router:this.$Router,Utils:this.$Utils,submitData:{title:"",content:"",type:1,bannerImg:[],keywords:""}}},onLoad:function(){var t=this;e.setStorageSync("canClick",!0);var n=function(e){t.$Utils.loadAll(["getLocation","getUserInfoData"],t)};t.$Token.getProjectToken(n,{refreshToken:!0})},methods:{formIdAdd:function(e){var t=this;console.log(e),t.$apis.WxFormIdAdd(e.detail.formId,Date.parse(new Date)/1e3+604800)},getUserInfoData:function(){var t=this,n=new Date((new Date).setHours(0,0,0,0)).getTime()/1e3,o=Date.parse(new Date)/1e3,a={tokenFuncName:"getProjectToken"};a.searchItem={user_no:e.getStorageSync("user_info").user_no},a.getAfter={todayScore:{tableName:"FlowLog",searchItem:{create_time:["between",[n,o]],status:1,type:3,user_no:wx.getStorageSync("user_info").user_no,relation_table:"message"},middleKey:"user_no",key:"user_no",condition:"in",compute:{count:["sum","count",{create_time:["between",[n,o]],status:1,type:3,user_no:wx.getStorageSync("user_info").user_no,relation_table:"message",count:[">",0]}]}}};var s=function(e){e.info.data.length>0?t.userInfoData=e.info.data[0]:t.$Utils.showToast("没有更多了","none"),console.log("self.getUserInfoData",t.getUserInfoData),t.$Utils.finishFunc("getUserInfoData")};t.$apis.userInfoGet(a,s)},getLocation:function(){var e=this,t=function(t){if(t){if(console.log("res",t),t.authSetting)return void console.log(232);e.submitData.keywords=t.address_component.city}};e.$Utils.getLocation("reverseGeocoder",t),e.$Utils.finishFunc("getLocation")},upLoadImg:function(e){var t=this;wx.showLoading({mask:!0,title:"上传中"});var n=function(e){console.log("res",e),1e5==e.solely_code?(t.submitData.bannerImg.push(e.info.url),console.log(t.submitData),wx.hideLoading()):t.$Utils.showToast("网络故障","none")};wx.chooseImage({count:1,success:function(e){console.log(e);var o=e.tempFilePaths[0];console.log(n),t.$Utils.uploadFile(o,"file",{tokenFuncName:"getProjectToken",type:"image"},n)},fail:function(e){wx.hideLoading()}})},submit:function(){var t=this;e.setStorageSync("canClick",!1);var n=t.$Utils.checkComplete(t.submitData);if(n){var o=function(e,n){t.submitData.mainImg=[],t.submitData.description=e.nickName,t.submitData.mainImg.push(e.avatarUrl),t.messageAdd(),console.log("user",e),console.log("res",n)};t.$Utils.getAuthSetting(o)}else e.setStorageSync("canClick",!0),t.$Utils.showToast("请补全信息","none"),console.log(t.submitData)},messageAdd:function(){var t=this,n=Date.parse(new Date);n=t.$Utils.timeto(n,"ymd-hms");var o={tokenFuncName:"getProjectToken"};wx.getStorageSync("user_info")&&wx.getStorageSync("user_info").headImgUrl||(o.refreshToken=!0),o.data={},o.data=t.$Utils.cloneForm(t.submitData),o.data.behavior=0,console.log("postData",o);var a=function(n){1e5==n.solely_code?(t.$Utils.showToast("发布成功","none"),setTimeout(function(){e.navigateBack({delta:1})},800)):(e.setStorageSync("canClick",!0),t.$Utils.showToast(n.msg,"none",1e3))};t.$apis.messageAdd(o,a)}}};t.default=n}).call(this,n("543d")["default"])},"632e":function(e,t,n){},"775b":function(e,t,n){"use strict";n.r(t);var o=n("549d"),a=n("4cf2");for(var s in a)"default"!==s&&function(e){n.d(t,e,function(){return a[e]})}(s);n("ecf2");var i=n("2877"),r=Object(i["a"])(a["default"],o["a"],o["b"],!1,null,null,null);t["default"]=r.exports},ecf2:function(e,t,n){"use strict";var o=n("632e"),a=n.n(o);a.a}},[["5c0d","common/runtime","common/vendor"]]]);